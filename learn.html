<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¯Ø±ÙˆØ³ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</title>
    <style>
        * {margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Traditional Arabic',Arial,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px}
        .container{max-width:1200px;margin:0 auto}
        
        .audio-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);z-index:10000;display:flex;align-items:center;justify-content:center}
        .audio-overlay.hidden{display:none}
        .audio-overlay-content{background:white;padding:60px;border-radius:20px;text-align:center;max-width:500px;animation:fadeIn 0.5s}
        @keyframes fadeIn{from{opacity:0;transform:scale(0.9)}to{opacity:1;transform:scale(1)}}
        .audio-overlay-content h2{color:#667eea;font-size:2.5em;margin-bottom:20px}
        .audio-overlay-content p{font-size:1.3em;margin-bottom:30px;color:#666}
        .audio-activate-btn{background:linear-gradient(135deg,#4caf50 0%,#45a049 100%);color:white;border:none;padding:20px 50px;border-radius:30px;font-size:1.8em;cursor:pointer;box-shadow:0 10px 30px rgba(0,0,0,0.3);transition:transform 0.2s;animation:pulse 2s infinite}
        @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
        .audio-activate-btn:hover{transform:scale(1.1)}
        
        .top-nav{position:fixed;top:20px;width:100%;max-width:1200px;left:50%;transform:translateX(-50%);display:flex;justify-content:space-between;padding:0 20px;z-index:1000}
        .language-selector select{padding:10px 15px;border-radius:25px;border:none;background:white;color:#667eea;font-size:1em;cursor:pointer;box-shadow:0 5px 15px rgba(0,0,0,0.2)}
        .nav-btn{background:linear-gradient(135deg,#4caf50 0%,#45a049 100%);color:white;border:none;padding:12px 20px;border-radius:25px;cursor:pointer;font-size:1em;box-shadow:0 5px 15px rgba(0,0,0,0.2);transition:transform 0.2s;text-decoration:none;display:inline-block}
        .nav-btn:hover{transform:scale(1.05)}
        
        header{background:white;padding:30px;border-radius:15px;text-align:center;margin-top:80px;margin-bottom:30px;box-shadow:0 10px 30px rgba(0,0,0,0.2)}
        h1{color:#667eea;font-size:2.5em;margin-bottom:10px}
        
        .user-progress{display:flex;justify-content:space-around;align-items:center;background:#f8f9fa;padding:15px;border-radius:10px;margin-top:20px}
        .progress-item{text-align:center}
        .progress-item h3{color:#667eea;font-size:1.8em}
        .badges{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
        .badge{width:50px;height:50px;background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5em;box-shadow:0 5px 15px rgba(0,0,0,0.3)}
        .badge.locked{background:#ddd;opacity:0.5}
        
        .main-view{display:none}
        .main-view.active{display:block}
        
        .modules-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin-top:30px}
        .module-card{background:white;padding:25px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.2);transition:transform 0.3s;cursor:pointer}
        .module-card:hover{transform:translateY(-5px)}
        .module-card h2{color:#667eea;margin-bottom:15px;font-size:1.8em}
        .progress-bar{width:100%;height:10px;background:#e0e0e0;border-radius:5px;overflow:hidden;margin:10px 0}
        .progress-fill{height:100%;background:linear-gradient(90deg,#667eea 0%,#764ba2 100%);transition:width 0.5s}
        .module-btn{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border:none;padding:12px 25px;border-radius:25px;cursor:pointer;font-size:1.1em;width:100%;margin-top:15px}
        
        .lesson-content{background:white;padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.2);margin-top:20px}
        
        .alphabet-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:15px;margin:20px 0}
        .letter-card{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);padding:20px;border-radius:15px;text-align:center;cursor:pointer;transition:transform 0.3s;color:white}
        .letter-card:hover{transform:scale(1.1)}
        .letter-card.completed{background:linear-gradient(135deg,#4caf50 0%,#45a049 100%)}
        .arabic-letter{font-size:2.5em;margin-bottom:5px}
        .letter-name{font-size:1em}
        
        .quiz-container{background:#f8f9fa;padding:25px;border-radius:15px;margin-top:30px}
        .quiz-progress{text-align:center;font-size:1.2em;color:#667eea;margin-bottom:20px}
        .quiz-question{font-size:1.5em;color:#333;margin-bottom:20px;text-align:center}
        .quiz-display{font-size:4em;text-align:center;color:#667eea;margin:30px 0}
        .quiz-options{display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin-top:20px}
        .quiz-option{background:white;padding:20px;border-radius:10px;text-align:center;cursor:pointer;transition:all 0.3s;border:3px solid transparent;font-size:1.2em}
        .quiz-option:hover{border-color:#667eea;transform:scale(1.05)}
        .quiz-option.correct{background:#4caf50;color:white;animation:celebrate 0.5s}
        .quiz-option.incorrect{background:#f44336;color:white;animation:shake 0.5s}
        @keyframes celebrate{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
        @keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-10px)}75%{transform:translateX(10px)}}
        
        .vocab-card{background:white;padding:20px;border-radius:15px;margin-bottom:15px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 5px 15px rgba(0,0,0,0.1);transition:transform 0.3s}
        .vocab-card:hover{transform:translateX(-5px)}
        .vocab-arabic{font-size:2em;color:#667eea}
        .vocab-translation{color:#666;font-size:1.2em}
        .audio-btn{background:white;color:#f5576c;border:none;padding:8px 15px;border-radius:20px;cursor:pointer;margin-top:10px;font-size:0.9em;transition:all 0.3s}
        .audio-btn:hover{transform:scale(1.1)}
        
        .grammar-section{background:#f8f9fa;padding:20px;border-radius:15px;margin-bottom:20px}
        .example-box{background:white;padding:15px;border-radius:10px;margin-top:10px;border-right:5px solid #667eea}
        
        .achievement-popup{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);background:white;padding:40px;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,0.4);text-align:center;z-index:10000;transition:transform 0.5s}
        .achievement-popup.show{transform:translate(-50%,-50%) scale(1)}
        .achievement-icon{font-size:5em;margin-bottom:20px}
        
        .back-btn{background:#666;color:white;border:none;padding:10px 20px;border-radius:20px;cursor:pointer;margin-bottom:20px}
        
        @media (max-width:768px){
            .top-nav{flex-direction:column;gap:10px}
            .modules-grid{grid-template-columns:1fr}
            .quiz-options{grid-template-columns:1fr}
            header{margin-top:140px}
        }
    </style>
</head>
<body>
    <div class="audio-overlay" id="audioOverlay">
        <div class="audio-overlay-content">
            <h2>ğŸ”Š ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª</h2>
            <p>Ø§Ø¶ØºØ· Ø§Ù„Ø²Ø± Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª ÙˆØ§Ù„Ø¨Ø¯Ø¡ ÙÙŠ Ø§Ù„ØªØ¹Ù„Ù…</p>
            <button class="audio-activate-btn" id="activateAudioBtn">ğŸ¤ Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¹Ù„Ù…</button>
        </div>
    </div>

    <div class="top-nav">
        <div class="language-selector">
            <select id="languageSelect">
                <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                <option value="fr">FranÃ§ais</option>
                <option value="en">English</option>
            </select>
        </div>
        <div><a href="index.html" class="nav-btn">ğŸ“– ØµÙØ­Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†</a></div>
    </div>

    <div class="container">
        <header>
            <h1>ğŸŒ™ ØªØ¹Ù„Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…Ø¹ Ø§Ù„Ù‚Ø±Ø¢Ù†</h1>
            <p>Ø±Ø­Ù„ØªÙƒ Ù„Ø¥ØªÙ‚Ø§Ù† Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</p>
            <div class="user-progress">
                <div class="progress-item"><h3 id="totalPoints">0</h3><p>Ø§Ù„Ù†Ù‚Ø§Ø·</p></div>
                <div class="progress-item"><h3 id="completedLessons">0</h3><p>Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</p></div>
                <div class="progress-item">
                    <div class="badges">
                        <div class="badge locked">ğŸ¯</div>
                        <div class="badge locked">â­</div>
                        <div class="badge locked">ğŸ†</div>
                        <div class="badge locked">ğŸ‘‘</div>
                    </div>
                </div>
            </div>
        </header>

        <div id="homeView" class="main-view active">
            <div class="modules-grid">
                <div class="module-card" onclick="showModule('alphabet')">
                    <h2>ğŸ“š Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø£Ø¨Ø¬Ø¯ÙŠØ©</h2>
                    <p>ØªØ¹Ù„Ù… 28 Ø­Ø±ÙØ§Ù‹ ÙÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</p>
                    <div class="progress-bar"><div class="progress-fill" id="alphabetProgress" style="width:0%"></div></div>
                    <p><span id="alphabetProgressText">0</span>% Ù…ÙƒØªÙ…Ù„</p>
                    <button class="module-btn">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¹Ù„Ù…</button>
                </div>
                <div class="module-card" onclick="showModule('vowels')">
                    <h2>âœ¨ Ø§Ù„Ø­Ø±ÙƒØ§Øª ÙˆØ§Ù„Ù…Ø¯ÙˆØ¯</h2>
                    <p>Ø§ØªÙ‚Ù† Ø§Ù„ÙØªØ­Ø© ÙˆØ§Ù„ÙƒØ³Ø±Ø© ÙˆØ§Ù„Ø¶Ù…Ø©</p>
                    <div class="progress-bar"><div class="progress-fill" id="vowelsProgress" style="width:0%"></div></div>
                    <p><span id="vowelsProgressText">0</span>% Ù…ÙƒØªÙ…Ù„</p>
                    <button class="module-btn">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¹Ù„Ù…</button>
                </div>
                <div class="module-card" onclick="showModule('vocabulary')">
                    <h2>ğŸ“– Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠØ©</h2>
                    <p>ØªØ¹Ù„Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù…Ù† Ø§Ù„Ù‚Ø±Ø¢Ù†</p>
                    <div class="progress-bar"><div class="progress-fill" id="vocabProgress" style="width:0%"></div></div>
                    <p><span id="vocabProgressText">0</span>% Ù…ÙƒØªÙ…Ù„</p>
                    <button class="module-btn">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¹Ù„Ù…</button>
                </div>
                <div class="module-card" onclick="showModule('grammar')">
                    <h2>âš™ï¸ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h2>
                    <p>ØªØ¹Ù„Ù… Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¬Ù…Ù„ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</p>
                    <div class="progress-bar"><div class="progress-fill" id="grammarProgress" style="width:0%"></div></div>
                    <p><span id="grammarProgressText">0</span>% Ù…ÙƒØªÙ…Ù„</p>
                    <button class="module-btn">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¹Ù„Ù…</button>
                </div>
            </div>
        </div>

        <div id="alphabetView" class="main-view">
            <div class="lesson-content">
                <button class="back-btn" onclick="showHome()">â† Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
                <h2>ğŸ“š ØªØ¹Ù„Ù… Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø£Ø¨Ø¬Ø¯ÙŠØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</h2>
                <p>Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ ÙƒÙ„ Ø­Ø±Ù Ù„Ø³Ù…Ø§Ø¹ Ù†Ø·Ù‚Ù‡</p>
                <div class="alphabet-grid" id="alphabetGrid"></div>
                <div class="quiz-container">
                    <h3>Ø§Ø®ØªØ¨Ø± Ù†ÙØ³Ùƒ!</h3>
                    <div class="quiz-progress" id="alphabetQuizProgress">0 / 28</div>
                    <div class="quiz-question">Ù…Ø§ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø±ÙØŸ</div>
                    <div class="quiz-display" id="alphabetQuizLetter"></div>
                    <div class="quiz-options" id="alphabetQuizOptions"></div>
                </div>
            </div>
        </div>

        <div id="vowelsView" class="main-view">
            <div class="lesson-content">
                <button class="back-btn" onclick="showHome()">â† Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
                <h2>âœ¨ Ø§Ù„Ø­Ø±ÙƒØ§Øª ÙˆØ§Ù„Ù…Ø¯ÙˆØ¯</h2>
                <div class="grammar-section">
                    <h3>Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù‚ØµÙŠØ±Ø©</h3>
                    <div class="example-box">
                        <div class="arabic-letter">Ø¨Ù</div>
                        <div>Ø§Ù„ÙØªØ­Ø© - Fatha (son "a")</div>
                        <button class="audio-btn" onclick="playSound('Ø¨Ù')">ğŸ”Š Ø§Ø³ØªÙ…Ø¹</button>
                    </div>
                    <div class="example-box">
                        <div class="arabic-letter">Ø¨Ù</div>
                        <div>Ø§Ù„ÙƒØ³Ø±Ø© - Kasra (son "i")</div>
                        <button class="audio-btn" onclick="playSound('Ø¨Ù')">ğŸ”Š Ø§Ø³ØªÙ…Ø¹</button>
                    </div>
                    <div class="example-box">
                        <div class="arabic-letter">Ø¨Ù</div>
                        <div>Ø§Ù„Ø¶Ù…Ø© - Damma (son "ou")</div>
                        <button class="audio-btn" onclick="playSound('Ø¨Ù')">ğŸ”Š Ø§Ø³ØªÙ…Ø¹</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="vocabularyView" class="main-view">
            <div class="lesson-content">
                <button class="back-btn" onclick="showHome()">â† Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
                <h2>ğŸ“– Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h2>
                <h3>Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø­Ø³Ù†Ù‰</h3>
                <div id="allahNamesContainer"></div>
                <h3 style="margin-top:30px">ÙƒÙ„Ù…Ø§Øª Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø©</h3>
                <div id="prayerVocabContainer"></div>
            </div>
        </div>

        <div id="grammarView" class="main-view">
            <div class="lesson-content">
                <button class="back-btn" onclick="showHome()">â† Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
                <h2>âš™ï¸ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h2>
                <div class="grammar-section">
                    <h3>Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ÙØ¹Ù„ ÙˆØ§Ù„Ø­Ø±Ù</h3>
                    <div class="example-box">
                        <div class="arabic-letter">Ù…Ø­Ù…Ø¯ØŒ ÙƒØªØ§Ø¨ØŒ Ù…Ø³Ø¬Ø¯</div>
                        <div>Ø§Ù„Ø§Ø³Ù… - Nom (personne, chose, lieu)</div>
                    </div>
                    <div class="example-box">
                        <div class="arabic-letter">ÙƒØªØ¨ØŒ Ù‚Ø±Ø£ØŒ Ø°Ù‡Ø¨</div>
                        <div>Ø§Ù„ÙØ¹Ù„ - Verbe (action)</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="achievement-popup" id="achievementPopup">
            <div class="achievement-icon">ğŸ‰</div>
            <h2 id="achievementTitle">Ø¥Ù†Ø¬Ø§Ø² Ø¬Ø¯ÙŠØ¯!</h2>
            <p id="achievementText">Ù„Ù‚Ø¯ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ ÙˆØ³Ø§Ù… Ø¬Ø¯ÙŠØ¯</p>
            <button class="module-btn" onclick="closeAchievement()">Ø±Ø§Ø¦Ø¹!</button>
        </div>
    </div>

    <script>
        const arabicLetters=[{letter:'Ø§',name:'Ø£Ù„Ù'},{letter:'Ø¨',name:'Ø¨Ø§Ø¡'},{letter:'Øª',name:'ØªØ§Ø¡'},{letter:'Ø«',name:'Ø«Ø§Ø¡'},{letter:'Ø¬',name:'Ø¬ÙŠÙ…'},{letter:'Ø­',name:'Ø­Ø§Ø¡'},{letter:'Ø®',name:'Ø®Ø§Ø¡'},{letter:'Ø¯',name:'Ø¯Ø§Ù„'},{letter:'Ø°',name:'Ø°Ø§Ù„'},{letter:'Ø±',name:'Ø±Ø§Ø¡'},{letter:'Ø²',name:'Ø²Ø§ÙŠ'},{letter:'Ø³',name:'Ø³ÙŠÙ†'},{letter:'Ø´',name:'Ø´ÙŠÙ†'},{letter:'Øµ',name:'ØµØ§Ø¯'},{letter:'Ø¶',name:'Ø¶Ø§Ø¯'},{letter:'Ø·',name:'Ø·Ø§Ø¡'},{letter:'Ø¸',name:'Ø¸Ø§Ø¡'},{letter:'Ø¹',name:'Ø¹ÙŠÙ†'},{letter:'Øº',name:'ØºÙŠÙ†'},{letter:'Ù',name:'ÙØ§Ø¡'},{letter:'Ù‚',name:'Ù‚Ø§Ù'},{letter:'Ùƒ',name:'ÙƒØ§Ù'},{letter:'Ù„',name:'Ù„Ø§Ù…'},{letter:'Ù…',name:'Ù…ÙŠÙ…'},{letter:'Ù†',name:'Ù†ÙˆÙ†'},{letter:'Ù‡',name:'Ù‡Ø§Ø¡'},{letter:'Ùˆ',name:'ÙˆØ§Ùˆ'},{letter:'ÙŠ',name:'ÙŠØ§Ø¡'}];
        
        const allahNames=[{arabic:'Ø§Ù„Ù„Ù‡',translation:'Allah'},{arabic:'Ø§Ù„Ø±Ø­Ù…Ù†',translation:'Le MisÃ©ricordieux'},{arabic:'Ø§Ù„Ø±Ø­ÙŠÙ…',translation:'Le TrÃ¨s MisÃ©ricordieux'},{arabic:'Ø§Ù„Ù…Ù„Ùƒ',translation:'Le Roi'},{arabic:'Ø§Ù„Ù‚Ø¯ÙˆØ³',translation:'Le Pur'},{arabic:'Ø§Ù„Ø³Ù„Ø§Ù…',translation:'La Paix'}];
        
        const prayerVocab=[{arabic:'ØµÙ„Ø§Ø©',translation:'PriÃ¨re'},{arabic:'ÙˆØ¶ÙˆØ¡',translation:'Ablution'},{arabic:'Ø±ÙƒÙˆØ¹',translation:'Inclinaison'},{arabic:'Ø³Ø¬ÙˆØ¯',translation:'Prosternation'}];

        let audioEnabled=false,arabicVoice=null;
        let userProgress={points:0,completedLessons:0,moduleProgress:{alphabet:0,vowels:0,vocabulary:0,grammar:0}};
        let currentQuiz={items:[],currentIndex:0,correctAnswers:0};

        function initAudio(){
            if('speechSynthesis'in window){
                const voices=window.speechSynthesis.getVoices();
                if(voices.length>0){
                    arabicVoice=voices.find(v=>v.lang.startsWith('ar'));
                }else{
                    window.speechSynthesis.onvoiceschanged=()=>{
                        arabicVoice=window.speechSynthesis.getVoices().find(v=>v.lang.startsWith('ar'));
                    };
                }
            }
        }

        document.getElementById('activateAudioBtn').addEventListener('click',function(){
            audioEnabled=true;
            document.getElementById('audioOverlay').classList.add('hidden');
            if('speechSynthesis'in window){
                const test=new SpeechSynthesisUtterance('Ù…Ø±Ø­Ø¨Ø§');
                if(arabicVoice)test.voice=arabicVoice;
                test.lang='ar-SA';
                window.speechSynthesis.speak(test);
            }
            console.log('Audio activated');
        });

        function playSound(text){
            if(!audioEnabled){console.log('Audio not enabled');return;}
            if('speechSynthesis'in window){
                window.speechSynthesis.cancel();
                const u=new SpeechSynthesisUtterance(text);
                if(arabicVoice)u.voice=arabicVoice;
                u.lang='ar-SA';
                u.rate=0.7;
                window.speechSynthesis.speak(u);
                addPoints(5);
            }
        }

        function loadProgress(){
            const saved=localStorage.getItem('arabicProgress');
            if(saved){
                userProgress=JSON.parse(saved);
                updateProgressDisplay();
            }
        }

        function saveProgress(){
            localStorage.setItem('arabicProgress',JSON.stringify(userProgress));
            updateProgressDisplay();
        }

        function updateProgressDisplay(){
            document.getElementById('totalPoints').textContent=userProgress.points;
            document.getElementById('completedLessons').textContent=userProgress.completedLessons;
            const badges=document.querySelectorAll('.badge');
            if(userProgress.points>=100)badges[0].classList.remove('locked');
            if(userProgress.points>=300)badges[1].classList.remove('locked');
            if(userProgress.points>=600)badges[2].classList.remove('locked');
            if(userProgress.points>=1000)badges[3].classList.remove('locked');
            ['alphabet','vowels','vocabulary','grammar'].forEach(m=>{
                const el=document.getElementById(m+'Progress');
                const textEl=document.getElementById(m+'ProgressText');
                if(el)el.style.width=userProgress.moduleProgress[m]+'%';
                if(textEl)textEl.textContent=Math.round(userProgress.moduleProgress[m]);
            });
        }

        function addPoints(p){
            userProgress.points+=p;
            saveProgress();
        }

        function showAchievement(title,text){
            document.getElementById('achievementTitle').textContent=title;
            document.getElementById('achievementText').textContent=text;
            document.getElementById('achievementPopup').classList.add('show');
        }

        function closeAchievement(){
            document.getElementById('achievementPopup').classList.remove('show');
        }

        function showHome(){
            document.querySelectorAll('.main-view').forEach(v=>v.classList.remove('active'));
            document.getElementById('homeView').classList.add('active');
        }

        function showModule(name){
            document.querySelectorAll('.main-view').forEach(v=>v.classList.remove('active'));
            document.getElementById(name+'View').classList.add('active');
            if(name==='alphabet')initAlphabetModule();
            if(name==='vocabulary')initVocabularyModule();
        }

        function initAlphabetModule(){
            const grid=document.getElementById('alphabetGrid');
            grid.innerHTML='';
            arabicLetters.forEach(letter=>{
                const card=document.createElement('div');
                card.className='letter-card';
                card.innerHTML=`<div class="arabic-letter">${letter.letter}</div><div class="letter-name">${letter.name}</div>`;
                card.onclick=()=>playSound(letter.letter);
                grid.appendChild(card);
            });
            startAlphabetQuiz();
        }

        function startAlphabetQuiz(){
            currentQuiz={items:[...arabicLetters],currentIndex:0,correctAnswers:0};
            currentQuiz.items.sort(()=>Math.random()-0.5);
            showNextAlphabetQuestion();
        }

        function showNextAlphabetQuestion(){
            if(currentQuiz.currentIndex>=currentQuiz.items.length){
                userProgress.completedLessons++;
                userProgress.moduleProgress.alphabet=100;
                saveProgress();
                showAchievement('ğŸ‰ Ø£Ø­Ø³Ù†Øª!',`Ø£ÙƒÙ…Ù„Øª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø­Ø±ÙˆÙ! ${currentQuiz.correctAnswers}/${currentQuiz.items.length}`);
                startAlphabetQuiz();
                return;
            }
            const correct=currentQuiz.items[currentQuiz.currentIndex];
            const options=[correct];
            while(options.length<4){
                const random=arabicLetters[Math.floor(Math.random()*arabicLetters.length)];
                if(!options.find(o=>o.name===random.name))options.push(random);
            }
            options.sort(()=>Math.random()-0.5);
            document.getElementById('alphabetQuizProgress').textContent=`${currentQuiz.currentIndex+1} / ${currentQuiz.items.length}`;
            document.getElementById('alphabetQuizLetter').textContent=correct.letter;
            const container=document.getElementById('alphabetQuizOptions');
            container.innerHTML='';
            options.forEach(option=>{
                const div=document.createElement('div');
                div.className='quiz-option';
                div.textContent=option.name;
                div.onclick=()=>checkAlphabetAnswer(option.name,correct.name,div);
                container.appendChild(div);
            });
            setTimeout(()=>playSound(correct.letter),500);
        }

        function checkAlphabetAnswer(selected,correct,element){
            if(selected===correct){
                element.classList.add('correct');
                addPoints(10);
                currentQuiz.correctAnswers++;
                const progress=(currentQuiz.correctAnswers/currentQuiz.items.length)*100;
                userProgress.moduleProgress.alphabet=Math.round(progress);
                saveProgress();
                setTimeout(()=>{
                    currentQuiz.currentIndex++;
                    showNextAlphabetQuestion();
                },1000);
            }else{
                element.classList.add('incorrect');
                setTimeout(()=>element.classList.remove('incorrect'),800);
            }
        }

        function initVocabularyModule(){
            const allah=document.getElementById('allahNamesContainer');
            allah.innerHTML='';
            allahNames.forEach(item=>{
                const card=document.createElement('div');
                card.className='vocab-card';
                card.innerHTML=`<div class="vocab-arabic">${item.arabic}</div><div class="vocab-translation">${item.translation}</div><button class="audio-btn" onclick="playSound('${item.arabic}')">ğŸ”Š</button>`;
                allah.appendChild(card);
            });
            const prayer=document.getElementById('prayerVocabContainer');
            prayer.innerHTML='';
            prayerVocab.forEach(item=>{
                const card=document.createElement('div');
                card.className='vocab-card';
                card.innerHTML=`<div class="vocab-arabic">${item.arabic}</div><div class="vocab-translation">${item.translation}</div><button class="audio-btn" onclick="playSound('${item.arabic}')">ğŸ”Š</button>`;
                prayer.appendChild(card);
            });
        }

        document.addEventListener('DOMContentLoaded',()=>{
            console.log('Initializing...');
            loadProgress();
            initAudio();
        });
    </script>
</body>
</html>
