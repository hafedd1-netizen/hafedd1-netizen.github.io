<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ููุตุฉ ุชุญููุธ ุงููุฑุขู ุงูุชูุงุนููุฉ</title>
<style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Traditional Arabic',Arial,sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);direction:rtl;min-height:100vh;padding:15px}
    .header{background:white;padding:20px;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,0.2);margin-bottom:15px;text-align:center}
    h1{color:#667eea;font-size:28px;margin-bottom:5px}
    .main-container{display:flex;gap:15px;max-width:1600px;margin:0 auto}
    .controls-sidebar{width:320px;flex-shrink:0}
    .controls{background:white;padding:18px;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,0.2);margin-bottom:15px}
    .section{margin-bottom:15px;padding-bottom:15px;border-bottom:1px solid #eee}
    select, button{width:100%;padding:10px;border-radius:8px;border:1px solid #ccc;font-size:16px}
    #content{flex:1;background:white;padding:15px;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,0.2);overflow-y:auto}
    .verse{margin-bottom:10px;padding:10px;background:#f8f9ff;border-radius:8px;}
    .arabic{font-size:24px;line-height:1.8;}
    .loading{text-align:center;padding:40px;font-size:20px;color:#667eea}
    .user-playback audio{width:100%;margin-top:10px;}
</style>
</head>
<body>

<div class="header">
    <h1>๐ ููุตุฉ ุชุญููุธ ุงููุฑุขู ุงููุฑูู</h1>
    <a href="lessons.html" style="padding:10px 20px;background:#28a745;color:white;text-decoration:none;border-radius:8px;">๐ ุฏุฑูุณ ุงููุบุฉ ุงูุนุฑุจูุฉ</a>
</div>

<div class="main-container">
    <div class="controls-sidebar">
        <div class="controls">
            <div class="section">
                <label for="surah">ุงูุณูุฑุฉ:</label>
                <select id="surah">
                    <option value="1">1-ุงููุงุชุญุฉ</option><option value="2">2-ุงูุจูุฑุฉ</option><option value="3">3-ุขู ุนูุฑุงู</option><option value="4">4-ุงููุณุงุก</option><option value="5">5-ุงููุงุฆุฏุฉ</option><option value="6">6-ุงูุฃูุนุงู</option><option value="7">7-ุงูุฃุนุฑุงู</option><option value="8">8-ุงูุฃููุงู</option><option value="9">9-ุงูุชูุจุฉ</option><option value="10">10-ูููุณ</option><option value="11">11-ููุฏ</option><option value="12">12-ููุณู</option><option value="13">13-ุงูุฑุนุฏ</option><option value="14">14-ุฅุจุฑุงููู</option><option value="15">15-ุงูุญุฌุฑ</option><option value="16">16-ุงููุญู</option><option value="17">17-ุงูุฅุณุฑุงุก</option><option value="18">18-ุงูููู</option><option value="19">19-ูุฑูู</option><option value="20">20-ุทู</option><option value="21">21-ุงูุฃูุจูุงุก</option><option value="22">22-ุงูุญุฌ</option><option value="23">23-ุงููุคูููู</option><option value="24">24-ุงูููุฑ</option><option value="25">25-ุงููุฑูุงู</option><option value="26">26-ุงูุดุนุฑุงุก</option><option value="27">27-ุงูููู</option><option value="28">28-ุงููุตุต</option><option value="29">29-ุงูุนููุจูุช</option><option value="30">30-ุงูุฑูู</option><option value="31">31-ูููุงู</option><option value="32">32-ุงูุณุฌุฏุฉ</option><option value="33">33-ุงูุฃุญุฒุงุจ</option><option value="34">34-ุณุจุฃ</option><option value="35">35-ูุงุทุฑ</option><option value="36">36-ูุณ</option><option value="37">37-ุงูุตุงูุงุช</option><option value="38">38-ุต</option><option value="39">39-ุงูุฒูุฑ</option><option value="40">40-ุบุงูุฑ</option><option value="41">41-ูุตูุช</option><option value="42">42-ุงูุดูุฑู</option><option value="43">43-ุงูุฒุฎุฑู</option><option value="44">44-ุงูุฏุฎุงู</option><option value="45">45-ุงูุฌุงุซูุฉ</option><option value="46">46-ุงูุฃุญูุงู</option><option value="47">47-ูุญูุฏ</option><option value="48">48-ุงููุชุญ</option><option value="49">49-ุงูุญุฌุฑุงุช</option><option value="50">50-ู</option><option value="51">51-ุงูุฐุงุฑูุงุช</option><option value="52">52-ุงูุทูุฑ</option><option value="53">53-ุงููุฌู</option><option value="54">54-ุงูููุฑ</option><option value="55">55-ุงูุฑุญูู</option><option value="56">56-ุงููุงูุนุฉ</option><option value="57">57-ุงูุญุฏูุฏ</option><option value="58">58-ุงููุฌุงุฏูุฉ</option><option value="59">59-ุงูุญุดุฑ</option><option value="60">60-ุงูููุชุญูุฉ</option><option value="61">61-ุงูุตู</option><option value="62">62-ุงูุฌูุนุฉ</option><option value="63">63-ุงูููุงูููู</option><option value="64">64-ุงูุชุบุงุจู</option><option value="65">65-ุงูุทูุงู</option><option value="66">66-ุงูุชุญุฑูู</option><option value="67">67-ุงูููู</option><option value="68">68-ุงูููู</option><option value="69">69-ุงูุญุงูุฉ</option><option value="70">70-ุงููุนุงุฑุฌ</option><option value="71">71-ููุญ</option><option value="72">72-ุงูุฌู</option><option value="73">73-ุงููุฒูู</option><option value="74">74-ุงููุฏุซุฑ</option><option value="75">75-ุงูููุงูุฉ</option><option value="76">76-ุงูุฅูุณุงู</option><option value="77">77-ุงููุฑุณูุงุช</option><option value="78">78-ุงููุจุฃ</option><option value="79">79-ุงููุงุฒุนุงุช</option><option value="80">80-ุนุจุณ</option><option value="81">81-ุงูุชูููุฑ</option><option value="82">82-ุงูุงููุทุงุฑ</option><option value="83">83-ุงููุทูููู</option><option value="84">84-ุงูุงูุดูุงู</option><option value="85">85-ุงูุจุฑูุฌ</option><option value="86">86-ุงูุทุงุฑู</option><option value="87">87-ุงูุฃุนูู</option><option value="88">88-ุงูุบุงุดูุฉ</option><option value="89">89-ุงููุฌุฑ</option><option value="90">90-ุงูุจูุฏ</option><option value="91">91-ุงูุดูุณ</option><option value="92">92-ุงูููู</option><option value="93">93-ุงูุถุญู</option><option value="94">94-ุงูุดุฑุญ</option><option value="95">95-ุงูุชูู</option><option value="96">96-ุงูุนูู</option><option value="97">97-ุงููุฏุฑ</option><option value="98">98-ุงูุจููุฉ</option><option value="99">99-ุงูุฒูุฒูุฉ</option><option value="100">100-ุงูุนุงุฏูุงุช</option><option value="101">101-ุงููุงุฑุนุฉ</option><option value="102">102-ุงูุชูุงุซุฑ</option><option value="103">103-ุงูุนุตุฑ</option><option value="104">104-ุงูููุฒุฉ</option><option value="105">105-ุงูููู</option><option value="106">106-ูุฑูุด</option><option value="107">107-ุงููุงุนูู</option><option value="108">108-ุงูููุซุฑ</option><option value="109">109-ุงููุงูุฑูู</option><option value="110">110-ุงููุตุฑ</option><option value="111">111-ุงููุณุฏ</option><option value="112">112-ุงูุฅุฎูุงุต</option><option value="113">113-ุงูููู</option><option value="114">114-ุงููุงุณ</option>
                </select>
            </div>
            <div class="section">
                <label for="hide-percentage">ูุณุจุฉ ุงูุฅุฎูุงุก:</label>
                <select id="hide-percentage">
                    <option value="10">10%</option><option value="20">20%</option><option value="30">30%</option><option value="40">40%</option><option value="50" selected>50%</option><option value="60">60%</option><option value="70">70%</option><option value="80">80%</option><option value="90">90%</option><option value="100">100%</option>
                </select>
            </div>
            <div class="section">
                <button id="hide-btn">ุฅุฎูุงุก</button>
                <button id="reveal-btn">ุฅุธูุงุฑ</button>
            </div>
        </div>
    </div>
    <div id="content"><div class="loading">ุฌุงุฑู ุงูุชุญููู...</div></div>
</div>

<script>
    const surahSelect = document.getElementById('surah');
    const contentDiv = document.getElementById('content');

    async function fetchWithTimeout(resource, timeout = 15000) {
        const controller = new AbortController();
        const id = setTimeout(() => controller.abort(), timeout);
        const response = await fetch(resource, { signal: controller.signal });
        clearTimeout(id);
        return response;
    }

    async function loadSurah(surahNumber) {
        contentDiv.innerHTML = '<div class="loading">ุฌุงุฑู ุชุญููู ุงูุณูุฑุฉ...</div>';
        try {
            const response = await fetchWithTimeout(`https://api.alquran.cloud/v1/surah/${surahNumber}/ar.alafasy`);
            if (!response.ok) throw new Error('Network response was not ok.');
            const data = await response.json();
            displaySurah(data.data);
        } catch (error) {
            contentDiv.innerHTML = `<div class="loading">ูุดู ุชุญููู ุงูุจูุงูุงุช. ูุฑุฌู ุงูุชุญูู ูู ุงุชุตุงูู ุจุงูุฅูุชุฑูุช. (${error.message})</div>`;
        }
    }

    function displaySurah(surah) {
        contentDiv.innerHTML = `<h2>${surah.name}</h2>`;
        surah.ayahs.forEach((ayah, index) => {
            const verseDiv = document.createElement('div');
            verseDiv.className = 'verse';
            verseDiv.innerHTML = `
                <p class="arabic">${ayah.text} (${ayah.numberInSurah})</p>
                <button onclick="playAudio('${ayah.audio}')">โถ๏ธ ุงุณุชูุงุน</button>
                <button onclick="startRecording(${index})">๐ค ุชุณุฌูู</button>
                <button onclick="stopRecording(${index})" disabled>โน๏ธ ุฅููุงู</button>
                <div class="user-playback" id="playback-${index}"></div>
            `;
            contentDiv.appendChild(verseDiv);
        });
    }

    let mediaRecorder;
    let audioChunks = [];
    let activeRecordingIndex = null;

    function playAudio(audioUrl) {
        const audio = new Audio(audioUrl);
        audio.play();
    }

    async function startRecording(index) {
        // ... (ููุฏ ุงูุชุณุฌูู ูู ุงูุฑุฏูุฏ ุงูุณุงุจูุฉ)
    }

    function stopRecording(index) {
        // ... (ููุฏ ุฅููุงู ุงูุชุณุฌูู ูู ุงูุฑุฏูุฏ ุงูุณุงุจูุฉ)
    }

    surahSelect.addEventListener('change', () => loadSurah(surahSelect.value));
    loadSurah(1); // ุชุญููู ุณูุฑุฉ ุงููุงุชุญุฉ ุนูุฏ ูุชุญ ุงูุตูุญุฉ
</script>

</body>
</html>
